SELECT Fund.fund_id,;
  Members.tpacode+Members.customer_id AS customer_id,;
  Members.customer_type,;
  ALLTRIM(Members.name)+" "+ALLTRIM(Members.surname) AS name,;
  Members.product, Members.plan_id, Members.policy_no, Members.sex,;
  Members.birth_date, Members.age, Members.premium, Members.exclusion,;
  Members.pay_fr, Members.status, Members.renew, Members.pay_status,;
  TTOD(Members.effective)+90 AS exclusion_wait, Fund.name AS fund_name,;
  Members.agent, Members.agentcy, Members.notation,;
  ALLTRIM(Members.h_addr1)+" "+ALLTRIM(Members.h_addr2)+" "+ALLTRIM(Members.h_city)+" "+ALLTRIM(Members.h_province)+" "+ALLTRIM(Members.h_postcode)+"  "+ALLTRIM(Members.h_phone) AS address,;
  Members.l_user, Members.l_update, Members.policy_group,;
  Members.policy_name, Members.family_no, Members.no_of_pers,;
  Fund.fundcode, Members.hb_cover, Members.hb_limit, Members.branch_code,;
  Members.pay_mode, Members.pay_seq, Members.title, Members.natid,;
  Members.effective_y, Members.expried_y, Members.overall_limit,;
  Members.l_submit, Members.payee, Members.agent_name, Members.agency_name,;
  Members.employee, Members.access_lvl, Members.tpacode,;
  Members.start_date,;
  IIF(EMPTY(Members.start_date),Members.policy_date,Members.start_date) AS policy_date,;
  IIF(EMPTY(Members.start_date),IIF(tpacode="ACE",TTOD(Members.effective),TTOD(Members.policy_date)),Members.start_date)+30 AS wait,;
  Members.h_addr1, Members.h_addr2, Members.h_city, Members.h_province,;
  Members.h_postcode, Members.h_country, Members.adj_plan_date,;
  Members.adj_permium_date, Members.policy_date AS rider_date,;
  Members.lastpaid, Members.oldeffective, Members.oldexpiry,;
  Members.oldplan, Members.end_serial, Members.pay_status,;
  Members.reindate, ALLTRIM(Members.agent_postcode) AS agent_address,;
  IIF(EMPTY(Members.policy_end),Members.expiry,Members.policy_end) AS expiry,;
  Members.polstatus, Members.adddate, Members.adjcancel, Members.quotation,;
  Members.canceldate, Members.lapsedate, Members.adjlapse, Members.adjrein,;
  Members.mobile, Members.infonote, Members.cardno,;
  Members.insure AS deductible,;
  IIF(Members.tpacode="SMG".AND.LEFT(Members.policy_no,1)="5",GOMONTH(GOMONTH(DATE(YEAR(expiry),MONTH(expiry),1),1),1)-1,TTOD(Members.expiry)+IIF(EMPTY(Members.status),31,0)) AS grace,;
  Members.effective;
 FROM ;
     cims!Fund ;
    INNER JOIN cims!Members ;
   ON  Fund.fundcode = Members.tpacode;
 WHERE  Members.tpacode = ( ?cFundCode );
   AND  Members.policy_no = ( ?cPolicyNo ) ;
UNION ALL ;
SELECT Fund.fund_id,;
  Members_1.tpacode+Members_1.customer_id AS customer_id,;
  Members_1.customer_type,;
  ALLTRIM(Members_1.name)+" "+ALLTRIM(Members_1.surname) AS name,;
  Members_1.product, Members_1.plan_id, Members_1.policy_no, Members_1.sex,;
  Members_1.birth_date, Members_1.age, Members_1.premium, Members_1.exclusion,;
  Members_1.pay_fr, Members_1.status, Members_1.renew, Members_1.pay_status,;
  TTOD(Members_1.effective)+90 AS exclusion_wait, Fund.name AS fund_name,;
  Members_1.agent, Members_1.agentcy, Members_1.notation,;
  ALLTRIM(Members_1.h_addr1)+" "+ALLTRIM(Members_1.h_addr2)+" "+ALLTRIM(Members_1.h_city)+" "+ALLTRIM(Members_1.h_province)+" "+ALLTRIM(Members_1.h_postcode)+"  "+ALLTRIM(Members_1.h_phone) AS address,;
  Members_1.l_user, Members_1.l_update, Members_1.policy_group,;
  Members_1.policy_name, Members_1.family_no, Members_1.no_of_pers,;
  Fund.fundcode, Members_1.hb_cover, Members_1.hb_limit, Members_1.branch_code,;
  Members_1.pay_mode, Members_1.pay_seq, Members_1.title, Members_1.natid,;
  Members_1.effective_y, Members_1.expried_y, Members_1.overall_limit,;
  Members_1.l_submit, Members_1.payee, Members_1.agent_name, Members_1.agency_name,;
  Members_1.employee, Members_1.access_lvl, Members_1.tpacode,;
  Members_1.start_date,;
  IIF(EMPTY(Members_1.start_date),Members_1.policy_date,Members_1.start_date) AS policy_date,;
  IIF(EMPTY(Members_1.start_date),IIF(tpacode="ACE",TTOD(Members_1.effective),TTOD(Members_1.policy_date)),Members_1.start_date)+30 AS wait,;
  Members_1.h_addr1, Members_1.h_addr2, Members_1.h_city, Members_1.h_province,;
  Members_1.h_postcode, Members_1.h_country, Members_1.adj_plan_date,;
  Members_1.adj_permium_date, Members_1.policy_date AS rider_date,;
  Members_1.lastpaid, Members_1.oldeffective, Members_1.oldexpiry,;
  Members_1.oldplan, Members_1.end_serial, Members_1.pay_status,;
  Members_1.reindate, ALLTRIM(Members_1.agent_postcode) AS agent_address,;
  IIF(EMPTY(Members_1.policy_end),Members_1.expiry,Members_1.policy_end) AS expiry,;
  Members_1.polstatus, Members_1.adddate, Members_1.adjcancel, Members_1.quotation,;
  Members_1.canceldate, Members_1.lapsedate, Members_1.adjlapse, Members_1.adjrein,;
  Members_1.mobile, Members_1.infonote, Members_1.cardno,;
  Members_1.insure AS deductible,;
  IIF(Members_1.tpacode="SMG".AND.LEFT(Members_1.policy_no,1)="5",GOMONTH(GOMONTH(DATE(YEAR(Members_1.expiry),MONTH(Members_1.expiry),1),1),1)-1,TTOD(Members_1.expiry)+IIF(EMPTY(Members_1.status),31,0)) AS grace,;
  Members_1.effective;
 FROM ;
     cims!Fund ;
    INNER JOIN cims!Members_1 ;
   ON  Fund.fundcode = Members_1.tpacode;
 WHERE  Members_1.tpacode = ( ?cFundCode );
   AND  Members_1.policy_no = ( ?cPolicyNo ) ;
 INTO CURSOR custbypersonnos
 