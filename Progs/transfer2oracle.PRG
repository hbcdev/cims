SET MULTILOCKS ON 
*-- Open Connection 
loConn = CREATEOBJECT('ADODB.Connection')
WITH loConn
.ConnectionString = "Provider=OraOLEDB.Oracle.1;Password=cims;Persist Security Info=True;User ID=cims;Data Source=dragon1:1521/XE;"
TRY
.Open()
CATCH TO loException
MESSAGEBOX( loException.Message,16,'Cannot connect ')
CANCEL
ENDTRY 
ENDWITH 
*-- Open Connection 
loCommand = CREATEOBJECT('ADODB.Command')
loCursor = CREATEOBJECT('CursorAdapter') 
WITH loCursor
.Alias = 'MemberDB'
.DataSourceType = 'ADO'
.DataSource = CREATEOBJECT('ADODB.Recordset')
.DataSource.CursorLocation = 3 && adUseClient
.DataSource.LockType = 3 && adLockOptimistic
.DataSource.ActiveConnection = loConn
.BufferModeOverride = 3 
.Tables = "Member"
.SelectCmd = [SELECT * FROM "Member"]
TEXT TO .CursorSchema
FUND_ID C(38), TPACODE C(3), POLICY_GROUP C(20), POLICY_NAME C(100), POLICY_NO C(30), 
FAMILY_NO C(38), NO_OF_PERS C(38), CUSTOMER_ID C(13), CUSTOMER_TYPE C(1), PRODUCT C(20), 
PLAN_ID C(10), OVERALL_LIMIT N(17, 4), EFFECTIVE_Y T, EXPRIED_Y T, NATID C(13), TITLE C(20), 
NAME C(60), MIDDLENAME C(30), SURNAME C(60), CONTACT_NAME C(60), CONTACT_PHONE C(20), 
H_ADDR1 C(60), H_ADDR2 C(60), H_CITY C(40), H_PROVINCE C(40), H_POSTCODE C(5), H_COUNTRY C(30),
H_PHONE C(15), WK_PHONE C(15), FAX C(15), MOBILE C(15), ACCESS_LVL C(1), L_ADDR1 C(60), 
L_ADDR2 C(60), L_CITY C(40), L_POSTCODE C(5), L_COUNTRY C(30), SEX C(1), OCCUPN_CODE C(8), 
BIRTH_DATE T, AGE C(38), POLICY_DATE T, EFFECTIVE T, EXPIRY T, PREMIUM N(17, 4), ADJ_PERMIUM_DATE T, 
ADJ_PLAN_DATE T, EXCLUSION M, AGENT C(20), AGENTCY C(20), PAY_FR C(2), PAY_MODE C(2), 
PAY_SEQ N(2, 0), STATUS C(1), RENEW N(3, 0), OLDEFFECTIVE T, OLDEXPIRY T, OLDPLAN C(8), 
OLDPERIUMN N(17, 4), OLD_OCCUPN_CODE C(8), PAY_STATUS C(1), NOTATION M, BRANCH_CODE C(8), 
INSURE C(38), PACKAGE C(8), CAUSE1 C(8), CAUSE2 C(8), CAUSE3 C(8), CAUSE4 C(8), CAUSE5 C(8), 
CAUSE6 C(8), CAUSE7 C(8), CAUSE8 C(8), CAUSE9 C(8), CAUSE10 C(8), CAUSE11 C(8), CAUSE12 C(8), 
L_SUBMIT T, HB_LIMIT N(17, 4), HB_COVER M, OCCUPN_CLASS C(2), EMPLOYEE C(10), PAYEE C(60), 
MAIL_ADDRESS M, L_USER C(8), L_UPDATE T, AGENT_NAME C(80), AGENCY_NAME C(60), AGENT_PROVINCE C(40), 
AGENT_ADDR1 C(50), AGENT_ADDR2 C(50), AGENT_ADDR3 C(50), AGENT_ADDR4 C(50), AGENT_PHONE C(30), 
AGENT_ADDR5 C(80), AGENT_ADDR6 C(80), AGENT_POSTCODE C(5), ADDRESS M, OLD_POLICYNO C(30), START_DATE T, 
DUTY C(80), POLICY_START T, POLICY_END T, END_SERIAL C(38)
ENDTEXT

.KeyFieldList = "FUND_ID"

TEXT TO .UpdateNameList noshow
FUND_ID Member.FUND_ID, TPACODE Member.TPACODE, POLICY_GROUP Member.POLICY_GROUP, POLICY_NAME Member.POLICY_NAME, POLICY_NO Member.POLICY_NO, FAMILY_NO Member.FAMILY_NO, NO_OF_PERS Member.NO_OF_PERS, CUSTOMER_ID Member.CUSTOMER_ID, CUSTOMER_TYPE Member.CUSTOMER_TYPE, PRODUCT Member.PRODUCT, PLAN_ID Member.PLAN_ID, OVERALL_LIMIT Member.OVERALL_LIMIT, EFFECTIVE_Y Member.EFFECTIVE_Y, EXPRIED_Y Member.EXPRIED_Y, NATID Member.NATID, TITLE Member.TITLE, NAME Member.NAME, MIDDLENAME Member.MIDDLENAME, SURNAME Member.SURNAME, CONTACT_NAME Member.CONTACT_NAME, CONTACT_PHONE Member.CONTACT_PHONE, H_ADDR1 Member.H_ADDR1, H_ADDR2 Member.H_ADDR2, H_CITY Member.H_CITY, H_PROVINCE Member.H_PROVINCE, H_POSTCODE Member.H_POSTCODE, H_COUNTRY Member.H_COUNTRY, H_PHONE Member.H_PHONE, WK_PHONE Member.WK_PHONE, FAX Member.FAX, MOBILE Member.MOBILE, ACCESS_LVL Member.ACCESS_LVL, L_ADDR1 Member.L_ADDR1, L_ADDR2 Member.L_ADDR2, L_CITY Member.L_CITY, L_POSTCODE Member.L_POSTCODE, L_COUNTRY Member.L_COUNTRY, SEX Member.SEX, OCCUPN_CODE Member.OCCUPN_CODE, BIRTH_DATE Member.BIRTH_DATE, AGE Member.AGE, POLICY_DATE Member.POLICY_DATE, EFFECTIVE Member.EFFECTIVE, EXPIRY Member.EXPIRY, PREMIUM Member.PREMIUM, ADJ_PERMIUM_DATE Member.ADJ_PERMIUM_DATE, ADJ_PLAN_DATE Member.ADJ_PLAN_DATE, EXCLUSION Member.EXCLUSION, AGENT Member.AGENT, AGENTCY Member.AGENTCY, PAY_FR Member.PAY_FR, PAY_MODE Member.PAY_MODE, PAY_SEQ Member.PAY_SEQ, STATUS Member.STATUS, RENEW Member.RENEW, OLDEFFECTIVE Member.OLDEFFECTIVE, OLDEXPIRY Member.OLDEXPIRY, OLDPLAN Member.OLDPLAN, OLDPERIUMN Member.OLDPERIUMN, OLD_OCCUPN_CODE Member.OLD_OCCUPN_CODE, PAY_STATUS Member.PAY_STATUS, NOTATION Member.NOTATION, BRANCH_CODE Member.BRANCH_CODE, INSURE Member.INSURE, PACKAGE Member.PACKAGE, CAUSE1 Member.CAUSE1, CAUSE2 Member.CAUSE2, CAUSE3 Member.CAUSE3, CAUSE4 Member.CAUSE4, CAUSE5 Member.CAUSE5, CAUSE6 Member.CAUSE6, CAUSE7 Member.CAUSE7, CAUSE8 Member.CAUSE8, CAUSE9 Member.CAUSE9, CAUSE10 Member.CAUSE10, CAUSE11 Member.CAUSE11, CAUSE12 Member.CAUSE12, L_SUBMIT Member.L_SUBMIT, HB_LIMIT Member.HB_LIMIT, HB_COVER Member.HB_COVER, OCCUPN_CLASS Member.OCCUPN_CLASS, EMPLOYEE Member.EMPLOYEE, PAYEE Member.PAYEE, MAIL_ADDRESS Member.MAIL_ADDRESS, L_USER Member.L_USER, L_UPDATE Member.L_UPDATE, AGENT_NAME Member.AGENT_NAME, AGENCY_NAME Member.AGENCY_NAME, AGENT_PROVINCE Member.AGENT_PROVINCE, AGENT_ADDR1 Member.AGENT_ADDR1, AGENT_ADDR2 Member.AGENT_ADDR2, AGENT_ADDR3 Member.AGENT_ADDR3, AGENT_ADDR4 Member.AGENT_ADDR4, AGENT_PHONE Member.AGENT_PHONE, AGENT_ADDR5 Member.AGENT_ADDR5, AGENT_ADDR6 Member.AGENT_ADDR6, AGENT_POSTCODE Member.AGENT_POSTCODE, ADDRESS Member.ADDRESS, OLD_POLICYNO Member.OLD_POLICYNO, START_DATE Member.START_DATE, DUTY Member.DUTY, POLICY_START Member.POLICY_START, POLICY_END Member.POLICY_END, END_SERIAL Member.END_SERIAL
ENDTEXT

TEXT TO .UpdatableFieldList noshow
FUND_ID, TPACODE, POLICY_GROUP, POLICY_NAME, POLICY_NO, FAMILY_NO, NO_OF_PERS, CUSTOMER_ID, CUSTOMER_TYPE, PRODUCT, PLAN_ID, OVERALL_LIMIT, EFFECTIVE_Y, EXPRIED_Y, NATID, TITLE, NAME, MIDDLENAME, SURNAME, CONTACT_NAME, CONTACT_PHONE, H_ADDR1, H_ADDR2, H_CITY, H_PROVINCE, H_POSTCODE, H_COUNTRY, H_PHONE, WK_PHONE, FAX, MOBILE, ACCESS_LVL, L_ADDR1, L_ADDR2, L_CITY, L_POSTCODE, L_COUNTRY, SEX, OCCUPN_CODE, BIRTH_DATE, AGE, POLICY_DATE, EFFECTIVE, EXPIRY, PREMIUM, ADJ_PERMIUM_DATE, ADJ_PLAN_DATE, EXCLUSION, AGENT, AGENTCY, PAY_FR, PAY_MODE, PAY_SEQ, STATUS, RENEW, OLDEFFECTIVE, OLDEXPIRY, OLDPLAN, OLDPERIUMN, OLD_OCCUPN_CODE, PAY_STATUS, NOTATION, BRANCH_CODE, INSURE, PACKAGE, CAUSE1, CAUSE2, CAUSE3, CAUSE4, CAUSE5, CAUSE6, CAUSE7, CAUSE8, CAUSE9, CAUSE10, CAUSE11, CAUSE12, L_SUBMIT, HB_LIMIT, HB_COVER, OCCUPN_CLASS, EMPLOYEE, PAYEE, MAIL_ADDRESS, L_USER, L_UPDATE, AGENT_NAME, AGENCY_NAME, AGENT_PROVINCE, AGENT_ADDR1, AGENT_ADDR2, AGENT_ADDR3, AGENT_ADDR4, AGENT_PHONE, AGENT_ADDR5, AGENT_ADDR6, AGENT_POSTCODE, ADDRESS, OLD_POLICYNO, START_DATE, DUTY, POLICY_START, POLICY_END, END_SERIAL
ENDTEXT

loCommand.ActiveConnection = loConn
IF !.CursorFill(.F.,.F.,0, loCommand)
AERROR(laErrors)
MESSAGEBOX( laErrors[2])
ENDIF 
ENDWITH


<< ปุ่ม command OK หลังเลือกค่าใน combo box แล้ว >>
lcCode = ThisForm.combo1.Value
=ThisForm.loCursor.CursorRefresh()
thisform.txtDocno.Value = caSignPayhead.docno
thisform.txtTrandate.Value = caSignPayHead.trandate
thisform.txtreccord_count.Value = caSignPayHead.record_count
thisform.txtinsurcode.Value = caSignPayHead.insurcode
ThisForm.Refresh
<< จบคำสั่งบน command.click >>

**** จากนั้นผมก็มีการแก้ไขค่าใน text box บน form 

<< ปุ่ม Save >>
caSignPayhead.docno = thisform.txtDocno.Value 
caSignPayHead.trandate = thisform.txtTrandate.Value
caSignPayHead.record_count = thisform.txtreccord_count.Value
caSignPayHead.insurcode = thisform.txtinsurcode.Value
TABLEUPDATE()
RETURN
